<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Login</title>
    </head>
    <body>
        <link rel="stylesheet" href="/public/style.css" />

        <div class="card">

            <h2>Login</h2>

            <input id="username" class="input" placeholder="username"><br/>
            <input id="password" class="input" placeholder="password" type="password"><br/>

            <button id="loginBtn" class="btn btn-primary">Login</button>

            <p style="margin-top: 12px;">
                <a href="/signup.html">Create account</a>
            </p>
        </div>
        

        <script>
            document.getElementById('loginBtn').addEventListener('click', async () => {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value.trim();

                const res = await fetch('http://localhost:8081/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json'},
                    body: JSON.stringify({ username, password })
                });

                const data = await res.json();
                if (!res.ok) return alert(data.message);

                localStorage.setItem('user', JSON.stringify(data.user));
                window.location.href = '/chat.html';
            });
        </script>
    </body>
</html>